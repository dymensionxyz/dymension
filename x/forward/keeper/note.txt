
/*
TODO's when I get back:
	- Can write the refunds to the recovery address
		HL -> EIBC, tokens are in module account
		EIBC -> Hyperlane, tokens are in user account
	- Should test the happy path e2e
	- Need to also reanalize the ibc test I wrote to see if I can include finalization or something
*/

/*
Does it make sense to store funds directly in module?
- It would be closer to PFM design and make refunds easier?

What are all the flows
	(assume for a moment no escrow within the forwarding module)

EIBC -> HL
	1. Token arrives in delayed ack, order is created
	2. Order is fulfilled, hook is called with funds provider and the other args, tokens are not yet moved
	3. Assume the memo contains the right details for the transfer to hyperlane
	4. Directly transfer funds from fulfiller to hyperlane
	Q: Hyperlane refund
		- There is no such thing as a refund on HL so there is no case to refund
	Q: What happens on finalization if EIBC was fulfilled?
		- Transfer is addressed to the eibc fulfiller
		- EIBC fulfiller will get the IBC tokens
	    TODO, need to test this
	Q: What happens if the transfer fails somehow?
	  1. Error returned to eibc fulfill operation
	  2. Fulfill will fail :(
	  	- Need to work on this. Best thing to do is to reduce chance it can fail on frontend.
		- At the end it can finalize, need to see what happens then. (See below)
		- Can optionally, directly send back to the original rollapp person, but not for MVP
	Q: What happens on finalization if EIBC was not fulfilled?
		TODO

	Investigations:
		- Will the transfer actually be accepted in the first place?
			- Is there somewhere in the code that checks that the transfer will be accepted by the rest of the IBC stack before accepting?
		    - Is this the same behaviour for recv, ack, timeout?
		- What should the IBC transfer recipient be? Can it be some nil value? Will it work? What if we just completely ignore it?
HL -> EIBC
	1. Token arrives on warp module
	2. Hook is called with the coins
	3. Unpack the memo and get the rol target address, this can just be baked into into the embedded IBC transfer object
	4. Send the IBC transfer
	Q: IBC transfer initiation fails
		- No such thing as a refund on HL, so would have to do the reverse transfer on HL
		- Easiest thing is to force specifying some refund address on the hub...
	Q: IBC transfer timeout
		- Sender would be the HL module
		- It should get a refund from ibc/eibc
	    - Then we are back in the transfer initiation failure case
	Q: IBC transfer error ack
		- Not for MVP, we should just make sure it's rare

	Investigations:
		- Can we just make the recipient some ignored value?
		- Does IBC transfer succ acc matter?


Extension:
	EIBC -> IBC
	HL ->IBC


Conclusions:
	Moving forward with the recovery address idea
High level investigations:
	Need to check that osmosis allows you to specify a memo on the ibc transfer
*/
